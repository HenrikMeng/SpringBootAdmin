<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fortran.admin.modules.sys.dao.UserDao">

   <select id="findByLoginName" resultType="User">
        select * from sys_user where login_name=#{loginName}
    </select>

    <select id="findByLoginNameAndLoginPwd" resultType="User">
        select * from sys_user where login_name=#{loginName} and login_pwd=#{loginPwd}
    </select>

    <select id="findRolesByLoginName" resultType="Role">
        select r.role_id,r.role_name from sys_user u
            LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id
            LEFT JOIN sys_role r ON ur.role_id = u.role_id
            WHERE u.login_name = #{loginName} AND  u.status = 0
                  AND  r.status = 0
    </select>


    <select id="findPermissionByLoginName" resultType="Menu">
        select m.* from sys_user u
        LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id
        LEFT JOIN sys_role r ON ur.role_id = r.role_id
        LEFT JOIN sys_role_menu rm ON r.role_id = rm.role_id
        LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id
        WHERE u.login_name = #{loginName} AND  u.status = 0
        AND  r.status = 0 AND m.status = 0
    </select>


</mapper>